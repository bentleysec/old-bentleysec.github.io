<!DOCTYPE html>
<html class="no-js" lang="en">
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>BentleySec - Sandbox Escape</title>
    <meta name="description" content="Home Page">
    <meta name="author" content="Steven Bentley">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- script
    ================================================== -->
    <script src="/js/modernizr.js"></script>
    <script defer src="/js/fontawesome/all.min.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="icon" href="/images/favicon.jpeg">
    <link rel="manifest" href="/site.webmanifest">

</head>

<body id="top">

    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-fade">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <!-- Header
    ================================================== -->
    <header class="s-header">

        <div class="row">

            <div class="s-header__content column">
                <h1 class="s-header__logotext">
                    <a href="/index.html" title=""><img src="/images/logo-dark.png"></a>
                </h1>
            </div>

        </div> <!-- end row -->

       <nav class="s-header__nav-wrap">

           <div class="row">

                <ul class="s-header__nav">
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="/projects/projects.html">Projects</a></li>
                    <li><a href="/blog.html">Blog</a>
                    <li><a href="/resources/resources.html">Resources</a></li>
                    <li><a href="/archive.html">Archive</a></li>
                </ul> 

           </div> 

        </nav> 

        <a class="header-menu-toggle" href="#0" title="Menu"><span>Menu</span></a>

    </header> <!-- Header End -->



    <!-- Content
    ================================================== -->
    <div class="s-content">

        <div class="row">

            <div id="main" class="s-content__main large-8 column">

    <article class="entry">

        <header class="entry__header">

            <h2 class="entry__title h1">
                Sandbox Escape
            </h2>       
        </header>
        
        <div class="entry__content">
            <h4>Shell Upgrade</h4>
                <p>Some Linux systems use restricted shells to keep users in a secure sandbox. Restricted shells limit the commands or applications that can be used. Common examples are found in the Bash shell using rbash or bash -r , in the Korn shell using rksh or ksh -r , and in the Bourne shell and similar shells using sh -r or rsh .</p>
                <p>Restricted shells commonly prevent users from changing directories, setting PATH or SHELL variables, specifying absolute pathnames, and redirecting output. Some may even add additional limitations, which can be frustrating when attempting to compromise a targeted host from a restricted account!</p>
                <p>Fortunately, breaking out of restricted shells can be as simple as starting a new unrestricted shell or using a utility like vi that has a built-in shell function to escape the Attacking Hosts329restricted shell! In general, when you are confronted with a restricted shell, you should do the following:</p>
                <ul>
                    <li>Check the commands you can run, particularly looking for SUID commands.</li>
                    <li>Check to see if you can use sudo and what sudo commands you can execute.</li>
                    <li>Check for languages like Perl, Python, or Ruby that you can run.</li>
                    <li>Check to see if you can use redirect operators like | or > and escape characters like single quotes, double quotes, or other execution tags.</li>
                </ul>
                <h4>VM</h4>
                <p>Attacking individual virtual machines normally follows the same process that attacks against a physical system would. In fact, in many cases you won’t know if you’re attacking a virtual machine, a container, or a physical machine until you have compromised it (and perhaps not even then!). If you suspect that you have compromised a virtual machine, you can look for common signs that the system is virtual, including the hardware that is presented to the operating system. In many cases, checking for the network interface card, or for virtualization plug-ins like VMware tools or VirtualBox extensions, can tell you if you have compromised a VM. On a Windows system, you can do this quite easily by using wmic:</p>
                <p><code>wmic baseboard get manufacturer,product</code></p>
                <p>The Linux <code>system-detect-virt</code> command is an easy way to determine what virtualization package is running if the system is running system-d. Other options include using the demidecode command, which can provide similar information, and checking the disk IDs to see if the system is being virtualized by using the <code>ls -l /dev/disk/by-id</code> listing command.</p>
                <p>Virtualization is rarely obfuscated in real-world production system environments, so detecting virtualization should be possible on most systems you encounter. Once you know which hypervisor you are dealing with, you can conduct research on the attack methods that may be available for that specific environment.</p>
                <p>Exploit tools that allow attackers to escape a virtual machine to directly attack the hypervisor have been sought after for years, with high prices paid for working exploits on the open market. Exploits have been found for VMware, Xen Project, Hyper-V, and VirtualBox, but each has been patched shortly after it was found. In most virtualization environments, VM escape isn’t likely to work unless a new exploit is introduced and you are able to use it to exploit a compromised host before it is patched by your target organization. That means that most penetration testers will be far more successful attacking the underlying administrative infrastructure so that they can access the virtualization management tools and systems than they will be if they rely on VM escape exploits.</p>
                <h4>Container</h4>
                <p>Attacks against OS-level virtualization tools like Docker often start by compromising the application that is running in the container. Typical penetration testing processes can be used, including port and vulnerability scanning and service exploitation. Once you have compromised a container, you can then attempt to access the container’s host — in fact, in some cases, like the vulnerable Docker instance that Not So Secure provides, you can simply run the Docker client from one of the vulnerable Docker containers and connect to the Docker daemon running on the virtual machine! As with most penetration testing efforts, you should carefully document the environment, check for misconfigurations and exposed or vulnerable services, and then pivot as you gain further access.</p>
   
        </div> 
</div> <!-- end main -->

<div id="sidebar" class="s-content__sidebar large-4 column">



    <div class="widget widget--categories">
        <h3 class="h6">Local Host Vulnerabilities</h3> 
        <ul>
            <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">OS Vulnerabilities</a></li>
            <ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">Windows</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">MAC OS</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">Linux</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">Android</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/OS_Vulnerabilities.html">iOS</a></li>
            </ul>
            <li><a class="link" href="/pentestplus/attacksandexploits/Unsecure_Service_and_Protocol_Configurations.html">Unsecure Service and Protocol Configurations</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Privilege Escalation</a></li>
            <ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Linux-Specific</a></li>
              <ul>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">SUID/SGID Programs</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Unsecure SUDO</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Ret2libc</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Sticky Bits</a></li>
              </ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Windows-Specific</a></li>
              <ul>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Cpassword</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Clear Text Credentials in LDAP</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Kerberoasting</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Credentials in LSASS</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Unattended Installation</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">SAM Database</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">DLL Hijacking</a></li>
              </ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Exploitable Services</a></li>
              <ul>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Unquoted Service Paths</a></li>
                <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Writable Services</a></li>
              </ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Unsecure File/Folder Permissions</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Keylogger</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Scheduled Tasks</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Privilege_Escalation.html">Kernel Exploits</a></li>
            </ul>
            <li><a class="link" href="/pentestplus/attacksandexploits/Default_Account_Settings.html">Default Account Settings</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Sandbox_Escape.html">Sandbox Escape</a></li>
            <ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Sandbox_Escape.html">Shell Upgrade</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Sandbox_Escape.html">VM</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Sandbox_Escape.html">Container</a></li>
            </ul>
            <li><a class="link" href="/pentestplus/attacksandexploits/Physical_Device_Security.html">Physical Device Security</a></li>
            <ul>
              <li><a class="link" href="/pentestplus/attacksandexploits/Physical_Device_Security.html">Cold Boot Attack</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Physical_Device_Security.html">JTAG Debug</a></li>
              <li><a class="link" href="/pentestplus/attacksandexploits/Physical_Device_Security.html">Serial Console</a></li>
            </ul>
            </ul>
          <h4><a href="/pentestplus/pentestplus.html">Pentest+ Home</a></h4>
          <h4><a href="/pentestplus/attacksandexploits/attacksandexploits.html">Attacks and Exploits</a></h4>
          <ul>
            <li><a class="link" href="/pentestplus/attacksandexploits/Social_Engineering_Attacks.html">Social Engineering Attacks</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Network-Based_Vulnerabilities.html">Network-Based Vulnerabilities</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Wireless_and_RF-Based_Vulnerabilities.html">Wireless and RF-Based Vulnerabilities</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Application-Based_Attacks.html">Application-Based Attacks</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Local_Host_Vulnerabilities.html">Local Host Vulnerabilities</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Physical_Security_Attacks.html">Physical Security Attacks</a></li>
            <li><a class="link" href="/pentestplus/attacksandexploits/Post-Exploitation_Techniques.html">Post-Exploitation Techniques</a></li>
        </ul>
        <h4><a href="/pentestplus/securitytools/securitytools.html">Security Tools</a></h4>
        
     </div>
    
</div> <!-- end sidebar -->


       </div> <!-- end row -->

   </div> <!-- end content-wrap -->


    <!-- Footer
    ================================================== -->
    <footer class="s-footer">

        <div class="row s-footer__top">
            <div class="column">
                <ul class="s-footer__social">
                    <li><a href="#0"><i class="fab fa-twitter" aria-hidden="true"></i></a></li>
                    <!-- <li><a href="#0"><i class="fab fa-youtube" aria-hidden="true"></i></a></li>
                    <li><a href="#0"><i class="fab fa-vimeo-v" aria-hidden="true"></i></a></li> -->
                    <li><a href="#0"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div> <!-- end footer__top -->

        <div class="row s-footer__bottom">

            <div class="large-6 tab-full column s-footer__info">
                <h3 class="h6">About BentleySec</h3>

                <p>

                </p>
            </div>

            <div class="large-6 tab-full column">
                <div class="row">

        
                    <div class="large-4 tab-full column">
                        <h3  class="h6">Navigate</h3>
        
                        <ul class="s-footer__list s-footer-list--nav group">
                            <li><a href="/index.html">Home</a></li>
                            <li><a href="/projects/projects.html">Projects</a></li>
                            <li><a href="/blog/blog.html">Blog</a>
                            <li><a href="/resources/resources.html">Resources</a></li>
                            <li><a href="/archive.html">Archive</a></li>
                        </ul>
                    </div>

                    <div class="large-8 tab-full column">

                        <img src="/images/logo-light.png">
        
                    </div>
                    
                </div>
            </div>

            <div class="ss-copyright">
                <span>© Copyright Bentleysec</span> 
                <span>Design by <a href="https://www.styleshout.com/">StyleShout</a></span>
            </div>

        </div> <!-- end footer__bottom -->


        <div class="ss-go-top">
            <a class="smoothscroll" title="Back to Top" href="#top">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0l8 9h-6v15h-4v-15h-6z"/></svg>
            </a>
        </div> <!-- end ss-go-top -->

    </footer> <!-- end Footer-->


    <!-- Java Script
    ================================================== -->
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/main.js"></script>

</body>

</html>