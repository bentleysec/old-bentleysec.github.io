---
layout: postexploitation
title: Lateral Movement
---


<div id="main" class="s-content__main large-8 column">

    <article class="entry">

        <header class="entry__header">

            <h2 class="entry__title h1">
                Lateral Movement
            </h2>       
        </header>
        
        <div class="entry__content">
            <p>Lateral movement is a technique used by attackers to move throughout an internal network in order to find sensitive information and other machines that could be used to escalate privileges.</p>
                <h4>RPC/DCOM</h4>
                    <p>RPC /DCOM (Remote Procedure Call/Distributed Component Object Model) were used mainly in Windows NT, 2000, XP, and 2003. RPC/DCOM provides communication between processes on different machines.</p>
                    <h5>PsExec</h5>
                        <p>PsExec is part of the SysInternal toolkit, it allows administrators to run programs remotely via SMB on port 445. PsExec, historically, has been used extensively and most anti-virus will block it's execution.</p>
                    <h5>WMI</h5>
                        <p>Windows Management Instrumentation (WMI) provides remote management and data gathering. A wide variety of information such as about SNMP, Windows Defender information, and Application Inventory listings is provided with WMI. Transfer of file, data gathering from files, remote execution of commands, files, and the Registry are allowed with WMI.</p>
                    <h5>Scheduled Tasks</h5>
                        <p>Attackers will use scheduled tasks to maintain persistence on a machine. A administrator may notice an out-of-place process and kill it, ending the attackers access to the machine. A scheduled tasks that runs every so often to re-open access to the machine ensures that the attacker can access the machine again.</p>
                <h4>PS Remoting/WinRM</h4>
                    <p>WinRM (Windows Remote Management) is a service that allows administrators to run powershell commands on a remote computer, a powerful tool for an attacker.</p>
                <h4>SMB</h4>
                    <p>Server Message Block (SMB) is used to share files and printers in a network, in Linux the service is called Samba. Many tools are available that can use SMB to discover the Operating System of the remote host.</p>
                    <p>Responder is a tool that can be used to get credentials for SMB. Responder works by responding to broadcasts on the network asking for SMB resources, identifying itself as the SMB resource. The victim then sends it's hashed credentials to the attacker.</p>
                <h4>RDP</h4>
                    <p>Remote Desktop Display (RDP) is commonly used by administrators to remotely access hosts on the network. Exploits are rare, but when there is one it can be devastating.</p>
                    <p>Seth is a tool that can be used as a man-in-the-middle attack. The attacker would need to know their own IP address, their Ethernet interface, the IP address of the victim (client), and the IP address of the target RDP host (server).</p>
                <h4>Apple Remote Desktop</h4>
                    <p>Apple Remote Desktop (ARD) is similar to RDP but for Apple. There was an exploit in MacOS 10 High Sierra that included a root exploit via Screen Sharing.</p>
                <h4>VNC</h4>
                    <p>Virtual Network Computing (VNC) is similar to RDP and ARP. Metasploit provides many VNC payloads, making it one of the easier means of getting remote GUI.</p>
                <h4>X-server Forwarding</h4>
                    <p>X11 - or X-Windows, often simplified to X, is the graphical system used in many Linux and Unix systems. X session can be forwarded uses an SSH tunnel to a remote computer. X-sessions that are not secure can be captured and exploited.</p>
                <h4>Telnet</h4>
                    <p>Telnet is an unencrypted service that provides remote shell access. Because the service is unencrypted, credentials are passed in clear text and easily stolen.</p>
                <h4>SSH</h4>
                    <p>SSH (secure shell) provides a remote shell through encryption. SSH is vulnerable if there is a vulnerable version installed or if the SSH keys are stolen by the attacker.</p>
                <h4>RSH/Rlogin</h4>
                    <p>The RSH/Rlogin service provides logins for remote servers. This is a legacy service and has been replaced by slogin and SSH. The service runs on port 513 and the command <code>rlogin -l root IP</code> allows one to login as root to the remote server.</p>
        </div>
</div> <!-- end main -->